# Healthcheck Service

Проект представляет собой сервис для мониторинга доступности веб-ресурсов с уведомлениями в Telegram о недоступных URL через бота.

## Основные функции
- Регулярная проверка доступности URL-адресов
- Отправка уведомлений администратору в Telegram о недоступных ресурсах
- Настраиваемый интервал проверок
- Поддержка множества URL для мониторинга
- Запуск в Docker-контейнере

## Структура проекта
```
.
├── .dockerignore             # Игнорируемые файлы и папки при сборке Docker-образа
├── .env.example              # Пример файла переменных окружения
├── .gitignore                # Игнорируемые файлы и папки при работе с Git
├── .python-version           # Версия Python для проекта
├── docker-compose.yml        # Конфигурация Docker Compose
├── Dockerfile                # Конфигурация Docker-образа
├── main.py                   # Основной скрипт приложения
├── pyproject.toml            # Зависимости проекта
├── README.md                 # Информация о проекте
└── uv.lock                   # UV lock file
```

## Требования
- Python 3.13+
- Docker (для запуска через контейнер)
- Аккаунт Telegram для работы с ботом

## Настройка переменных окружения
Создайте файл `.env` на основе `.env.example` со следующими параметрами:

```ini
ADMIN_ID = ваш_telegram_id       # ID администратора Telegram
BOT_TOKEN = "токен_бота"          # Токен Telegram-бота
DELAY_REQUESTS = 60               # Интервал проверок в секундах
URLS = "https://example.com, https://another.com"  # URL для мониторинга
```

### Как получить параметры:
1. **Telegram Bot Token**: создайте бота через [@BotFather](https://t.me/BotFather)
2. **ADMIN_ID**: получите через бота [@userinfobot](https://t.me/userinfobot)

## Запуск приложения

### Локальный запуск (без Docker)
1. Установите зависимости:
```bash
uv sync --frozen --no-dev
```

2. Запустите приложение:
```bash
uv run main.py
```

### Запуск с помощью Docker
1. Соберите Docker-образ:
```bash
docker compose build
```

2. Запустите сервис:
```bash
docker compose up -d
```

## Настройка Docker
- Сервис автоматически перезапускается при сбоях (`restart: always`)
- Конфигурация использует файл `.env` из текущей директории
- Порт не требуется, так как сервис работает как фоновый процесс

## Логика работы
1. При запуске бот отправляет список отслеживаемых URL
2. Сервис проверяет доступность URL с заданным интервалом
3. При обнаружении недоступного URL отправляется уведомление в Telegram
4. Проверка продолжается в фоновом режиме

## Зависимости
- aiogram (3.20+): работа с Telegram API
- httpx: асинхронные HTTP-запросы
- python-dotenv: загрузка переменных окружения
- uv: менеджер зависимостей и запуска приложений

## Примеры уведомлений
При запуске:
```
Bot started

Healthcheck urls list:
['https://example.com', 'https://another.com']
```

При недоступности ресурса:
```
URL https://down-site.com is unavailable
```
